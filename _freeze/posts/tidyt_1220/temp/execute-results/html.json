{
  "hash": "b8cf4bd96e2412ea72265504c1a4e925",
  "result": {
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nweather_forecasts <- read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-12-20/weather_forecasts.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 651968 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): city, state, high_or_low, forecast_outlook, possible_error\ndbl  (4): forecast_hours_before, observed_temp, forecast_temp, observed_precip\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ncities <- read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-12-20/cities.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 236 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): city, state, koppen\ndbl (8): lon, lat, elevation, distance_to_coast, wind, elevation_change_four...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\noutlook_meanings <- read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-12-20/outlook_meanings.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 23 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): forecast_outlook, meaning\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nskim(weather_forecasts)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |                  |\n|:------------------------|:-----------------|\n|Name                     |weather_forecasts |\n|Number of rows           |651968            |\n|Number of columns        |10                |\n|_______________________  |                  |\n|Column type frequency:   |                  |\n|character                |5                 |\n|Date                     |1                 |\n|numeric                  |4                 |\n|________________________ |                  |\n|Group variables          |None              |\n\n\n**Variable type: character**\n\n|skim_variable    | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:----------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|city             |         0|          1.00|   4|  15|     0|      160|          0|\n|state            |         0|          1.00|   2|   2|     0|       53|          0|\n|high_or_low      |         0|          1.00|   3|   4|     0|        2|          0|\n|forecast_outlook |     37875|          0.94|   3|   6|     0|       23|          0|\n|possible_error   |         0|          1.00|   4|  16|     0|        4|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|date          |         0|             1|2021-01-30 |2022-06-01 |2021-09-30 |      488|\n\n\n**Variable type: numeric**\n\n|skim_variable         | n_missing| complete_rate|  mean|    sd|  p0| p25| p50|   p75|  p100|hist  |\n|:---------------------|---------:|-------------:|-----:|-----:|---:|---:|---:|-----:|-----:|:-----|\n|forecast_hours_before |         0|          1.00| 30.00| 13.42|  12|  21|  30| 39.00|  48.0|▇▇▁▇▇ |\n|observed_temp         |     47744|          0.93| 57.56| 21.81| -47|  42|  59| 74.00| 122.0|▁▁▆▇▁ |\n|forecast_temp         |     37313|          0.94| 57.36| 21.82| -41|  42|  59| 74.00| 118.0|▁▁▆▇▂ |\n|observed_precip       |     50416|          0.92|  0.10|  0.32|   0|   0|   0|  0.02|  12.4|▇▁▁▁▁ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tsibble)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tsibble'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(fable)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: fabletools\n```\n:::\n\n```{.r .cell-code}\nlibrary(feasts)\nlibrary(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: timechange\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:tsibble':\n\n    interval\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nforecast_tsbl <- weather_forecasts |>\n  mutate(city = factor(city),\n         state = factor(state),\n         high_or_low = factor(high_or_low),\n         forecast_hours_before = factor(forecast_hours_before)) |> \n  as_tsibble(key = c(city, state, high_or_low, forecast_hours_before), index = date)\n\n\nforecast_tsbl |> \n  filter(city == \"NEWARK\", high_or_low == \"high\", forecast_hours_before == 12) |>\n  autoplot(observed_temp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#30 day train test split\n\ntrain <- forecast_tsbl |> \n  filter(city == \"NEWARK\", high_or_low == \"high\", forecast_hours_before == 12) |> \n  slice_head(n = -30)\n\ntest <- anti_join(forecast_tsbl |> \n  filter(city == \"NEWARK\", high_or_low == \"high\", forecast_hours_before == 12), train)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = c(\"date\", \"city\", \"state\", \"high_or_low\",\n\"forecast_hours_before\", \"observed_temp\", \"forecast_temp\", \"observed_precip\",\n\"forecast_outlook\", \"possible_error\")\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain |> features(observed_temp, unitroot_kpss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 6\n  city   state high_or_low forecast_hours_before kpss_stat kpss_pvalue\n  <fct>  <fct> <fct>       <fct>                     <dbl>       <dbl>\n1 NEWARK NJ    high        12                         1.70        0.01\n```\n:::\n\n```{.r .cell-code}\ntrain |> features(observed_temp, unitroot_ndiffs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 5\n  city   state high_or_low forecast_hours_before ndiffs\n  <fct>  <fct> <fct>       <fct>                  <int>\n1 NEWARK NJ    high        12                         1\n```\n:::\n\n```{.r .cell-code}\ntrain |> \n  mutate(diff_obs = difference(observed_temp)) |> \n  features(diff_obs, unitroot_kpss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 6\n  city   state high_or_low forecast_hours_before kpss_stat kpss_pvalue\n  <fct>  <fct> <fct>       <fct>                     <dbl>       <dbl>\n1 NEWARK NJ    high        12                        0.240         0.1\n```\n:::\n\n```{.r .cell-code}\ntrain |> features(observed_temp, unitroot_nsdiffs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 5\n  city   state high_or_low forecast_hours_before nsdiffs\n  <fct>  <fct> <fct>       <fct>                   <int>\n1 NEWARK NJ    high        12                          0\n```\n:::\n\n```{.r .cell-code}\ntrain |> autoplot(difference(observed_temp))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\ntrain |> autoplot(difference(observed_temp))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\ntrain |> ACF(difference(observed_temp)) |> autoplot()\n```\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\ntrain |> features(difference(observed_temp), feat_acf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 11\n  city   state high_or_low foreca…¹   acf1 acf10 diff1…² diff1…³ diff2…⁴ diff2…⁵\n  <fct>  <fct> <fct>       <fct>     <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1 NEWARK NJ    high        12       -0.153 0.115  -0.470   0.262  -0.611   0.418\n# … with 1 more variable: season_acf1 <dbl>, and abbreviated variable names\n#   ¹​forecast_hours_before, ²​diff1_acf1, ³​diff1_acf10, ⁴​diff2_acf1,\n#   ⁵​diff2_acf10\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain_fill <- train |> tidyr::fill(c(observed_temp))\n\ntrain_fill |> gg_tsdisplay(difference(observed_temp))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 row containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nets_train <- train_fill |> \n  model(ETS(observed_temp))\n\nets_train |> gg_tsresiduals()\n```\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nets_train |> report()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSeries: observed_temp \nModel: ETS(A,N,N) \n  Smoothing parameters:\n    alpha = 0.4993486 \n\n  Initial states:\n     l[0]\n 31.98279\n\n  sigma^2:  78.4931\n\n     AIC     AICc      BIC \n4808.361 4808.414 4820.741 \n```\n:::\n\n```{.r .cell-code}\nets_train |>\n  forecast(h = 30) |> \n  autoplot(train_fill)\n```\n\n::: {.cell-output-display}\n![](temp_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n",
    "supporting": [
      "temp_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}