{
  "hash": "a41b7c7af754b5436fd68f83271e14ed",
  "result": {
    "markdown": "---\ntitle: \"Tidy Tuesday - World Cup Edition\"\nauthor: \"Sam Weiner\"\ndate: \"2022-12-11\"\ncategories: [tidytuesday, analysis]\n---\n\n\n# TidyTuesday\n\nTidy Tuesday is an awesome initiative by the R for Data Science Community where data sets are published every week for the R community share any analysis and visualizations that can be conjured from the data!\n\n## World Cup Data\n\nThis data set contains data on every World Cup since 1930.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidytuesdayR)\nlibrary(tidymodels)\ntheme_set(theme_light())\n```\n:::\n\n\n## Load in the World Cup data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntt <- tt_load(\"2022-11-29\")\ntt\n```\n:::\n\n\n\n\nThis episode of Tidy Tuesday contains two data sets. wcmatches (matches from now on) contains 900 rows, one for each game played on the World Cup stage. It has variables for who played who, what stage or round of the tournament the game was played, who won, and the goals scored by each team.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches <- tt$wcmatches\nglimpse(matches)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 900\nColumns: 15\n$ year           <dbl> 1930, 1930, 1930, 1930, 1930, 1930, 1930, 1930, 1930, 1…\n$ country        <chr> \"Uruguay\", \"Uruguay\", \"Uruguay\", \"Uruguay\", \"Uruguay\", …\n$ city           <chr> \"Montevideo\", \"Montevideo\", \"Montevideo\", \"Montevideo\",…\n$ stage          <chr> \"Group 1\", \"Group 4\", \"Group 2\", \"Group 3\", \"Group 1\", …\n$ home_team      <chr> \"France\", \"Belgium\", \"Brazil\", \"Peru\", \"Argentina\", \"Ch…\n$ away_team      <chr> \"Mexico\", \"United States\", \"Yugoslavia\", \"Romania\", \"Fr…\n$ home_score     <dbl> 4, 0, 1, 1, 1, 3, 0, 0, 1, 6, 1, 0, 0, 4, 3, 6, 6, 4, 2…\n$ away_score     <dbl> 1, 3, 2, 3, 0, 0, 4, 3, 0, 3, 0, 1, 4, 0, 1, 1, 1, 2, 3…\n$ outcome        <chr> \"H\", \"A\", \"A\", \"A\", \"H\", \"H\", \"A\", \"A\", \"H\", \"H\", \"H\", …\n$ win_conditions <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ winning_team   <chr> \"France\", \"United States\", \"Yugoslavia\", \"Romania\", \"Ar…\n$ losing_team    <chr> \"Mexico\", \"Belgium\", \"Brazil\", \"Peru\", \"France\", \"Mexic…\n$ date           <date> 1930-07-13, 1930-07-13, 1930-07-14, 1930-07-14, 1930-0…\n$ month          <chr> \"Jul\", \"Jul\", \"Jul\", \"Jul\", \"Jul\", \"Jul\", \"Jul\", \"Jul\",…\n$ dayofweek      <chr> \"Sunday\", \"Sunday\", \"Monday\", \"Monday\", \"Tuesday\", \"Wed…\n```\n:::\n:::\n\n\nworldcups has information about each world cup on a high level. It contains information like the name of the host country each World Cup, the names of the top four finishers, total tournament goals scored, the number of teams, games, and attendants.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwcups <- tt$worldcups\nglimpse(wcups)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 21\nColumns: 10\n$ year         <dbl> 1930, 1934, 1938, 1950, 1954, 1958, 1962, 1966, 1970, 197…\n$ host         <chr> \"Uruguay\", \"Italy\", \"France\", \"Brazil\", \"Switzerland\", \"S…\n$ winner       <chr> \"Uruguay\", \"Italy\", \"Italy\", \"Uruguay\", \"West Germany\", \"…\n$ second       <chr> \"Argentina\", \"Czechoslovakia\", \"Hungary\", \"Brazil\", \"Hung…\n$ third        <chr> \"USA\", \"Germany\", \"Brazil\", \"Sweden\", \"Austria\", \"France\"…\n$ fourth       <chr> \"Yugoslavia\", \"Austria\", \"Sweden\", \"Spain\", \"Uruguay\", \"W…\n$ goals_scored <dbl> 70, 70, 84, 88, 140, 126, 89, 89, 95, 97, 102, 146, 132, …\n$ teams        <dbl> 13, 16, 15, 13, 16, 16, 16, 16, 16, 16, 16, 24, 24, 24, 2…\n$ games        <dbl> 18, 17, 18, 22, 26, 35, 32, 32, 32, 38, 38, 52, 52, 52, 5…\n$ attendance   <dbl> 434000, 395000, 483000, 1337000, 943000, 868000, 776000, …\n```\n:::\n:::\n\n\n# Explore the Data\n\nLet's first look the most common match scores for all the games. It looks like low scoring games are the most common.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches %>% \n  count(home_score, away_score, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 49 × 3\n   home_score away_score     n\n        <dbl>      <dbl> <int>\n 1          1          0    94\n 2          2          1    90\n 3          1          1    87\n 4          0          1    78\n 5          0          0    71\n 6          2          0    59\n 7          1          2    51\n 8          0          2    40\n 9          3          1    36\n10          2          2    34\n# … with 39 more rows\n```\n:::\n:::\n\n\nI want to visualize how many games there were for total goals scored between the home and away teams. We can do this by creating a new column (total_score) adding the two scores together and counting the number of games with that score.  \n\nWe can use ggplot2 to easily visualize our data. Also, by turning total_score into a factor, I can reorder the levels of the factors to reflect the number of matches each for each score. This makes the plot easily comprehensible.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'viridis'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:scales':\n\n    viridis_pal\n```\n:::\n\n```{.r .cell-code}\nmatches %>% \n  mutate(total_score = home_score + away_score) %>%\n  count(total_score, sort = TRUE) %>% \n  mutate(total_score = factor(total_score)) %>% \n  mutate(total_score = fct_reorder(total_score, n)) %>% \n  ggplot() +\n  geom_col(aes(total_score, n), fill = \"dark blue\") +\n  xlab(\"Total Match Score\") +\n  ylab(\"Number of Matches\") +\n  ggtitle(\"Number of World Cup Matches by Total Score\") +\n  theme(legend.position = \"none\") +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nIt looks like total score of 1, 2, and 3 are by far the most common score outcomes for world cup matches. Let's now look at the number of matches each country has one since 1930. We are going to visualize teams that have one more than 5 games at world cup and see who ranks on top. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches |> \n  filter(outcome != \"D\") |>\n  count(winning_team, sort = TRUE)|>\n  filter(n > 5) |> \n  ggplot() +\n  geom_col(aes(fct_reorder(winning_team, n, max), n), fill = \"dark green\") + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nBrazil is by far the most winningest team in World Cup history! But I which country has won the most games in the past 20 years?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches |> \n  filter(outcome != \"D\", year >= 2000) |>\n  count(winning_team, sort = TRUE)|>\n  filter(n > 5) |> \n  ggplot() +\n  geom_col(aes(fct_reorder(winning_team, n, max), n), fill = \"dark red\") + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nGermany has overcome Brazil! \n\nJust for fun, let's see which day of the week most World Cup matches are played. Hopefully this information can help you figure out how to spend your vacation days if you want to see the most action.\n\nWe are going to also stratify by which stage the games are being played, so if you are more interested in the games deeper in the bracket, we can see on what days those are played most often.\n\nHere I am removing the number associoted with each Group to get an overall Group category. Next, I am releveling the days of week variable to make them look a little nicer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches <- matches %>% \n  mutate(stage = if_else(str_detect(stage, \"^Group\"), \"Group\",stage)) %>% \n  mutate(stage = if_else(str_detect(stage, \"^ Group\"), \"Group\",stage)) %>% \n  mutate(dayofweek = factor(dayofweek, c(\"Monday\", \"Tuesday\", \"Wednesday\",\n                                         \"Thursday\", \"Friday\", \"Saturday\", \n                                         \"Sunday\")))\n```\n:::\n\n\nThe plot shows that most of the games are played on Saturday and Sunday. So no need to take a vacation day! But Tuesday and Wednesday seem to have the most Semifinal matches.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmatches %>%\n  filter(stage != \"Group\")|>\n  ggplot(aes(dayofweek, fill = stage)) + \n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## World Cup dataset\n\nAs was mentioned above, the World Cup dataset contains more general information about each World Cup. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwcups\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 21 × 10\n    year host        winner      second third fourth goals…¹ teams games atten…²\n   <dbl> <chr>       <chr>       <chr>  <chr> <chr>    <dbl> <dbl> <dbl>   <dbl>\n 1  1930 Uruguay     Uruguay     Argen… USA   Yugos…      70    13    18  434000\n 2  1934 Italy       Italy       Czech… Germ… Austr…      70    16    17  395000\n 3  1938 France      Italy       Hunga… Braz… Sweden      84    15    18  483000\n 4  1950 Brazil      Uruguay     Brazil Swed… Spain       88    13    22 1337000\n 5  1954 Switzerland West Germa… Hunga… Aust… Urugu…     140    16    26  943000\n 6  1958 Sweden      Brazil      Sweden Fran… West …     126    16    35  868000\n 7  1962 Chile       Brazil      Czech… Chile Yugos…      89    16    32  776000\n 8  1966 England     England     West … Port… Sovie…      89    16    32 1614677\n 9  1970 Mexico      Brazil      Italy  West… Urugu…      95    16    32 1673975\n10  1974 Germany     West Germa… Nethe… Pola… Brazil      97    16    38 1774022\n# … with 11 more rows, and abbreviated variable names ¹​goals_scored,\n#   ²​attendance\n```\n:::\n:::\n\n\nWe can count the number of total goals scored in a World Cup and rank them by which tournament had the most goals scored.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwcups %>% \n  count(year, wt = goals_scored, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 21 × 2\n    year     n\n   <dbl> <dbl>\n 1  1998   171\n 2  2014   171\n 3  2018   169\n 4  2002   161\n 5  2006   147\n 6  1982   146\n 7  2010   145\n 8  1994   141\n 9  1954   140\n10  1986   132\n# … with 11 more rows\n```\n:::\n:::\n\n\nLet's also visualize the relationship between number of goals scored and the number of matches played in each World Cup.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwcups %>% \n  ggplot(aes(year, goals_scored)) +\n  geom_line() +\n  geom_line(aes(year, games))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}